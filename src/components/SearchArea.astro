---
import { twJoin } from 'tailwind-merge';

const { isEN } = Astro.props;
---

<div
  id="search-area"
  aria-hidden="true"
  class={twJoin(
    'js-search-area fixed inset-x-0 bottom-0 z-10 grid content-start gap-4 border-t-4 border-orange-400 bg-white p-4 text-stone-700',
    'md:p-6',
    'xl:h-min xl:w-[min(calc(100%-67.5rem-5rem),30rem)]',
    'xl:bottom-auto xl:left-0 xl:right-auto xl:top-[--search-area-top] xl:translate-y-0 xl:rounded-r-xl xl:border-0 xl:p-4',
    'translate-y-0 transition-transform duration-300',
    'aria-hidden:translate-y-[calc(100%+1rem)]',
    'xl:aria-hidden:translate-x-[calc(-1*(100%+1.25rem))] xl:aria-hidden:translate-y-0'
  )}
>
  <div class="mx-auto grid w-full max-w-[67.5rem]">
    <div class="flex flex-col gap-2 md:flex-row md:gap-5 xl:flex-col xl:gap-1">
      <div class="flex items-center gap-0.5 font-bold">
        <div class="size-5 shrink-0">
          <img src="/assets/images/search.svg" alt="" class="size-[1.125rem]" />
        </div>
        <span>{isEN ? 'Site Search' : 'サイト内検索'}</span>
      </div>
      <form class="js-search-form flex flex-1 gap-2 text-base">
        <input
          type="text"
          aria-label={isEN ? 'Enter your search terms' : '検索したい内容を入力してください'}
          class="w-full max-w-[26.5rem] flex-1 appearance-none rounded border border-stone-400 px-2 py-1 md:rounded-lg xl:rounded"
        />
        <button
          disabled
          type="submit"
          class="shrink-0 rounded bg-orange-600 px-4 py-1 text-3.75 font-bold text-white disabled:cursor-not-allowed disabled:opacity-50 md:rounded-lg xl:rounded"
          >{isEN ? 'Search' : '検索'}</button
        >
      </form>
    </div>
    <div
      class={twJoin(
        'js-search-result invisible grid max-h-[8.75rem] scroll-pt-4 gap-3 overflow-y-auto overscroll-contain rounded-lg bg-stone-100 [word-break:break-word]',
        'md:max-h-[30svh]',
        'xl:max-h-[calc(100svh-var(--search-area-top)-10.75rem)] xl:scroll-pt-0 xl:rounded-none xl:bg-transparent',
        '[&.is-active]:visible [&.is-active]:mt-4 [&.is-active]:p-4 [&.is-active]:opacity-100 md:[&.is-active]:mt-6',
        '[&>div>div]:font-bold [&>div]:grid [&>div]:gap-3',
        '[&_li.is-searched]:bg-orange-100 [&_li]:border-t [&_li]:border-stone-300',
        '[&_a]:block [&_a]:py-3 hover:[&_a]:bg-stone-200 focus-visible:[&_a]:bg-stone-200',
        'xl:hover:[&_a]:bg-stone-100 xl:focus-visible:[&_a]:bg-stone-100',
        '[&_span]:text-orange-600',
        'xl:[&.is-active]:mt-8 xl:[&.is-active]:p-0 xl:[&.is-active]:pr-2'
      )}
      tabindex="-1"
    >
    </div>
  </div>
  <button
    aria-controls="search-area"
    class={twJoin(
      'js-close-trigger-search absolute -top-4 right-4 grid size-10 place-content-center rounded-full bg-orange-600',
      'xl:-right-5 xl:-top-5'
    )}
  >
    <img src="/assets/images/close.svg" alt="" class="size-4" />
    <span class="sr-only">{isEN ? 'Close' : '閉じる'}</span>
  </button>
</div>
<div aria-hidden="true" class="js-search-overlay visible fixed inset-0 aria-hidden:invisible aria-hidden:opacity-0">
</div>
